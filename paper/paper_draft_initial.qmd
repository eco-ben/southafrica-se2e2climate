---
title: Think deep for reef resilience
author:
  - name: Benjamin Grier
    email: grierben777@gmail.com
    affiliations:
        - id: UStrath
          name: University of Strathclyde
          address: Glasgow
          country: United Kingdom 
    attributes:
        corresponding: true
abstract: |
    Enter abstract text here.
keywords:
    - StrathE2E2
date: last-modified
format:
  elsevier-docx:
    journal:
      name: Ecological Modelling
      formatting: preprint
      cite-style: authoryear
bibliography: references.bib
engine: julia
crossref:
  custom:
  - kind: float
    reference-prefix: SFigure
    key: sfig
editor:
  markdown:
    wrap: 92
    canonical: true
---

# Introduction

# Methods

## Study Area

This investigation models the Southern Benguela ecosystem, extending from the northern South
Africa EEZ border to *x place* to meet the Aghulas current. To define the continental shelf
region included in this investigation, we exclude any areas that are situated at more than
800m depth. We define the inshore region of the domain as being continental shelf with a
depth of less than 50m and a distance to shore of 20km. This inshore region is defined to
separate the influence of nearshore processes such as river inputs and shore-based /
nearshore fishing pressure from the offshore region. The offshore region encapsulates all
other areas in the model domain beyond this boundary. The model domain is further separated
into 8 sediment-derived habitat types: rock, gravel, sand and mud bottom types for the
inshore and offshore zones. Sediment maps were digitised and georeferenced from Birch et al.
[-@birch1987]. These sediment types represent different levels of nutrient reflectance back
into the water column after settlement. The 8 habitat types are primarily used to
parameterise the distribution of fishing fleet pressure over the model domain area, rather
than explicitly represent the spatial distribution of the functional groups' biomass over
the habitats.

## Ecosystem model

We implement the StrathE2E end-to-end ecosystem model for the Southern Benguela region to
explore changes in ecosystem processes under future scenarios. StrathE2E models the flow of
nitrogen through the ecosystem using box models represented by couplped ordinary
differential equations. Nitrogen flow is tracked through a range of ecosystem components
from non-exploitable components such as disolved nitrogen, detritus and phytoplankton, to
exploitable guilds such as planktivorous fish, birds and seals. The models represent three
water volumes, inshore, shallow offshore and deep offshore. Representing the horizontal and
vertical flows of nutrients between these volumes, as well as external input of nutrients
from adjacent water masses and river inputs. Additional detail about the structure of
StrathE2E can be found in Heath et al. [-@heath2021].

### Parameterisation for Southern Benguela

To implement StrathE2E for the Southern Benguela ecosystem, we collated region-specific
inputs from available data, literature and regional expert knowledge. This includes input
data representing operating fishing fleets in the region and their catch of the modelled
guilds, biological event timing data for key regional species for each guild and
observational target data for parameter optimisation of the ecosystem model. Additionally,
environmental driving data for the model implementation region was extracted from NemoERSEM
output \*\*insert NEMO-ERSEM citation\*\* (See environmental driving data section below).

| Source | Model Inputs | Time Period / Climate Forcing |
|------------------------------------|-----------------------|---------------------------------|
| Sea Around Us - fishing catch data | Catch data separated into catch power (catch/activity) and discard rates | Parameterised with 2010-2019 data |
| South Africa National Biodiversity Institute - spatial fishing pressure data | Spatial distribution of fishing fleet activity |  |
| Regional expert collaboration - target data | Fitting target data |  |
| World Ocean Atlas 2023 - monthly nitrate concentration data | Fitting target data |  |
| Satellite data |  |  |
| Literature | Fishing fleet annual effort estimates, biological event timings | Parameterised using 2010-2019 literature, or nearest available time period values. |

: Data sources used for parameterisation of the 2010-2019 Southern Benguela StrathE2E model
and the model inputs that each data source contributed to. Full information for the
implementation process and processing and use of each data source can be found at
\*\*\\\[Insert implementation doc link.\\\]\*\*. {#tbl-data-sources}

### Environmental driving data

StrathE2E uses monthly driving data for physical and chemical variables annually averaged
from each decadal time period. Physical driving data includes variables such as temperature,
light, river inflow volumes and boundary flow rates for each water volume. Chemical driving
data include nutrient concentrations for each of the volumes and from sources such as water
volume boundaries and river inputs. Environmental driving data were extracted from
Nemo-ERSEM biogeochemical model forced by two Earth System Models (ESMs: CNRM and GFDL
**clarify the specific ESMs**) under two Shared-Socioeconomic-Pathways (SSPs: SSP1-2.6 and
SSP3-7.0). Environmental driving data were averaged across decades including 2010-2019,
2020-2029, 2030-2039, 2040-2049, 2050-2059, 2060-2069. Additional information on
environmental driving data can be found in **insert supplementary table ref**.

## Initial climate change analyses

To assess how future change may impact the Southern Benguela ecosystem we model the
ecosystem using driving data across the six decades, under the two ESMs and two SSPs. Under
these scenarios we explore the steady state biomass values, averaged across the domain area,
for each modelled guild. To initially assess the broad climate change impacts we visualise
these outputs as timeseries across the decades.

To explore the drivers and trends of ecosystem state under climate change we perform
principal component analysis (PCA) on the steady state biomass values, transforming the data
to two dimensions (PC1 and PC2). We can then perform in depth analyses of the environmental
driving data and their variable influence on the ecosystem under climate change.

## Climate permutation analyses

To explore the influence of environemntal input driving data on the ecosystem under
different contexts we perform permutation analyses to calculate the overall contribution of
each variable group to the ecosystem outcomes. To perform these analyses we group the
variables according to @tbl-variable-groups. Once a set of permuted models is created we
then collate annual biomass results for each target guild and calculate the Shapley value of
each variable for each of the target guild biomass result sets.

![Initial diagram showing the differences between the different investigation analysis
modes.](../data/initial_analysis_diagram.png){#fig-initial-analysis-diagram}

| Variables | Variable groups | Group description | Group varies across | Sources |
|-------------------|-------------------|-------------------|-------------------|-------------------|
| sslight | Light |  | Decade, ESM, SSP |  |
| so_temp, d_temp, si_temp | Temperature |  | Decade, ESM, SSP |  |
| rivervol, rivnitrate, rivammonia, rivdetritus | River outputs |  | Decade, ESM, SSP |  |
| logkvert, d_so_upwelling, so_d_downwelling | Vertical mixing |  | Decade, ESM, SSP |  |
| \*\_nitrate, \*\_ammonia, \*\_phyt, \*\_detritus | Volume nutrient concentrations |  | Decade, ESM, SSP |  |
| so_atmnitrate, so_atmammonia, si_atmnitrate, si_atmammonia | Atmospheric nutrient flux |  | Decade, SSP |  |

: Environmental variables that are altered in climate permutation analyses and the groups
allocated to variables, and levels they vary across. All other chemistry and physics driving
variables are constant across variants of the South African StrathE2E2 model. \* Volume
nutrient concentration variable group includes separate variables for each water volume (so,
si, d). {#tbl-variable-groups}

### Climate modelling scenario permutation analyses

To assess how our environmental drivers contribute to overall model results across the
future climate scenarios (ESMs and SSPs), we perform permutations of variable values across
possible climate scenarios within each decade analysed. Within each decade six variable
groups (light, temperature, river outputs, vertical mixing and volume nutrient
concentrations) vary across ESMs and SSPs, with four possible sets of values per decade
(CNRM-SSP1-2.6, CNRM-SSP3-7.0, GFDL-SSP1-2.6, GFDL-SSP3-7.0). The atmospheric nutrient flux
variable group varies across SSP only, with only two possible sets of values per decade.

To assess the influence of these variable groups across climate scenario derived model
variation, within each decade all unique combinations of variable group sets are used as
model inputs (@fig-initial-analysis-diagram). These unique permutations of climate variables
are then modelled across the 3 chosen decades. We then use these permutations to assess the
contribution of each variable group to the variation in model results across the the climate
change modelling scenarios.

The total number of permutations run can be calculated as:

4scenarios \^ 6variables \* 2scenarios \^ 1variable \* 3decades = 24,576 model permutations

### Climate change impacts permutation analyses

To understand how environmental drivers contribute to the model outputs under climate change
(across decades), we perform variable permutations across decades within each available
climate scenario set. There are four sets of unique climate scenarios (CNRM-SSP1-2.6,
CNRM-SSP3-7.0, GFDL-SSP1-2.6, GFDL-SSP3-7.0). Within each climate scenario seven variable
groups (light, temperature, river outputs, vertical mixing, volume nutrient concentrations
and atmospheric nutrient flux) vary across decades, with three possible sets of values per
climate scenario (2010-2019, 2030-2039, 2060-2069). For example, under CNRM-SSP1-2.6 climate
scenario the temperature variable group has three unique value sets (one for each decade).

To assess the influence of these variable groups across climate change derived model
variation, within each climate scenario all unique combinations of variable group sets are
used as model inputs (@fig-initial-analysis-diagram). These unique permutations of climate
variables are then supplied to the model as inputs across the four available climate
scenarios separately.

The total number of permutations run can be calculated as:

3decades \^ 7variables \* 4 scenarios = 8,248 model permutations

We then use these permutations to assess the contribution of each variable group to the
variation in model results across the decades. To identify groups of guilds (or
sub-networks) in the Southern Benguela ecosystem that may be influenced by similar sets of
variables we cluster the guilds based on their variable contribution values using a k-means
clustering algorithm.

### Variable swap analyses

Decade-swap permutations that have either a single variable group swapped to an alternative
decade, or all-but a single variable group swapped to an alternative decade are assessed.
Permutations with a single variable group substituted for an alternative decade are used to
investigate whether the selected variable group change is sufficient to drive climate change
impacts. Permutations with all-but a single variable group substituted are used to
investigate whether the constant variable group is necessary for driving climate change
impacts.

## Shapley effects

To calculate the importance of the variable groups for influencing the model outputs across
climate model scenarios and climate change futures, we perform Shapley effects analysis on
each set of inputs and results.

## Further analyses

# Results

### Future climate impacts

![Final year biomass conditions for each decade of forcing data under each future scenario.
The y axis represents the mean final year biomass in mMNm^-2^ for each guild type. The x
axis represents the model decades. The line colours represent the four future scenarios
analysed with CNRM-SSP1-2.6 represented in blue, CNRM-SSP3-7.0 represented in yellow,
GFDL-SSP1-2.6 represented in green and GFDL-SSP3-7.0 represented in pink. Results are shown
for the adult and larval fish guild biomasses (demersal fish, demersal fish larvae,
planktivorous fish, planktivorous fish larvae and migratory
fish).](../figs/initial_cc_assessment/biomass_timeseries.png){#fig-biomass-timeseries
width="14.82cm"}

![Panel A: PCA results for final year biomass conditions for each decade of forcing data
under each future scenario. The line colours represent the four future scenarios analysed
with CNRM-SSP1-2.6 represented in blue, CNRM-SSP3-7.0 represented in yellow, GFDL-SSP1-2.6
represented in green and GFDL-SSP3-7.0 represented in pink. Point shapes represent the
decade for which the model was run. Panel B: PCA axis loadings for each of the guild biomass
state variables.](../figs/initial_cc_assessment/biomass_timeseries.png){width="14.82cm"}

### Within decade scenario permutation analyses

### Within scenario decade permutation analyses

### Variable swap analyses

# Discussion

# References

::: {#refs}
:::

# Supplementary Material

## Model parameterisation and calibration

Model input data such as biological event timing and fisheries data were sourced from
regional and published sources **link to source table**. StrathE2E biological parameters
were calibrated using regional target observation data **link to target data source table**.
Calibration was performed using an iterative simulated annealing process where ecological
parameters **link to calibrated parameters table** are varied to increase the likelihood of
the ecological target data from simulated model results, then fishing harvest ratio
parameters are varied to calibrate the fishing model component. Once a suitable model fit is
reached the ecological and fishing parameters are calibrated together to the ecological and
fisheries landing target data. This fitting process was performed for a 2010-2015 CNRM
SSP3-7.0 baseline model. Additional information on model fitting can be found in **link to implementation doc**.